<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Formulaire RGPD compliant - HubSpot + Axeptio</title>

  <!-- Axeptio - À charger le plus tôt possible -->
  <script>
    window.axeptioSettings = {
      clientId: "6880d227f0b041d2ff94a814",
      cookiesVersion: "ambroisedu21/formulaire-consentement/indexaxeptio-fr-EU"
    };

    (function(d, s) {
      var t = d.getElementsByTagName(s)[0], e = d.createElement(s);
      e.async = true;
      e.src = "https://static.axept.io/sdk.js";
      t.parentNode.insertBefore(e, t);
    })(document, "script");

    // Lors du consentement Axeptio
    window._axcb = window._axcb || [];
    window._axcb.push(function (axeptio) {
      axeptio.on("cookies:complete", function (choices) {
        if (choices && choices.hubspot === true) {
          // Injecter les cookies + script de suivi HubSpot
          var hsScript = document.createElement("script");
          hsScript.type = "text/javascript";
          hsScript.async = true;
          hsScript.src = "https://js.hs-scripts.com/44344318.js"; // Ton Portal ID ici
          document.head.appendChild(hsScript);
        }
      });
    });
  </script>

  <style>
    body {
      font-family: sans-serif;
      margin: 30px;
    }
    #formulaire-wrapper {
      margin-top: 40px;
    }
  </style>
</head>
<body>

  <h2>Formulaire de contact</h2>

  <!-- Le formulaire natif HubSpot sera injecté ici -->
  <div id="formulaire-wrapper"></div>

  <script>
    // Toujours injecter le formulaire via API (même sans cookies)
    (function () {
      const script = document.createElement("script");
      script.src = "https://js.hsforms.net/forms/v2.js";
      script.type = "text/javascript";
      script.async = true;
      script.onload = function () {
        if (window.hbspt) {
          window.hbspt.forms.create({
            region: "eu1",
            portalId: "44344318", // Ton portal ID HubSpot
            formId: "4b18f182-dbe4-4607-9f62-ef4961f18f38", // Ton formulaire natif
            target: "#formulaire-wrapper"
          });
        }
      };
      document.head.appendChild(script);
    })();
  </script>

</body>
</html>
